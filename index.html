<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Text RPG Turn-Based (Modular)</title>
  <link rel="stylesheet" href="./styles.css?v=v37" />
</head>
<body>
  
      <!-- Auth / Cloud Login Overlay -->
  <div id="mainMenu" class="menuOverlay">
    <div class="menuCard">
      <h2 class="menuTitle">Cloud Login</h2>
      <p class="menuSub" id="authSub">Login untuk load progress dari cloud (bisa dipakai di PC &amp; HP).</p>

      <div class="authForm">
        <input id="authUser" class="authInput" placeholder="Username" autocomplete="username" />
        <input id="authPass" class="authInput" type="password" placeholder="Password" autocomplete="current-password" />
      </div>

      <div class="menuBtns">
        <button id="authLogin" class="btn primary">Login</button>
        <button id="authRegister" class="btn">Register</button>
        <button id="authOffline" class="btn danger">Main Offline</button>
      </div>

      <p class="menuHint" id="authMsg">Tip: Setelah login, game akan otomatis load cloud save. Kalau cloud belum ada save, save lokal akan di-upload.</p>
    </div>
  </div>

  <!-- Character Select Overlay -->
  <div id="charMenu" class="menuOverlay hidden">
    <div class="menuCard">
      <h2 class="menuTitle">Select Character</h2>
      <p class="menuSub" id="charSub">Pilih slot karakter (6 slot). Slot kosong bisa dibuat karakter baru.</p>

      <div id="charSlots" class="charGrid"></div>

      <div class="charFooter">
        <div id="charActions" class="charActions"></div>
      </div>

      <p class="menuHint" id="charMsg"></p>
    </div>
  </div>

  <!-- Create Character Form Overlay -->
  <div id="charCreateMenu" class="menuOverlay hidden">
    <div class="menuCard">
      <h2 class="menuTitle">Create Character</h2>
      <p class="menuSub" id="ccSub">—</p>

      <div class="authForm">
        <input id="ccName" class="authInput" placeholder="Nama karakter" autocomplete="off" />
        <input type="hidden" id="ccGender" value="male" />
        <div class="genderSelect">
          <button class="genderOption active" type="button" data-gender="male">
            <img class="genderIcon" src="./assets/icons/gender-male.svg" alt="Male" />
            <span>Male</span>
          </button>
          <button class="genderOption" type="button" data-gender="female">
            <img class="genderIcon" src="./assets/icons/gender-female.svg" alt="Female" />
            <span>Female</span>
          </button>
        </div>
      </div>

      <div class="menuBtns">
        <button id="ccCreate" class="btn primary">Create</button>
        <button id="ccCancel" class="btn">Cancel</button>
      </div>

      <p class="menuHint" id="ccMsg"></p>
    </div>
  </div>

<div class="wrap">
    <div class="topbar">
      <div class="brand">
        <img class="logo" src="./assets/logo.svg" alt="RPG Logo" />
        <h1>Text RPG Turn-Based <span class="pill" id="modePill">Town</span></h1>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT: Allies (Player + NPCs) -->
      <div class="allyRow" id="allyRow">
        <div class="card allyCard" id="playerCard">
        <div class="damageText" id="playerDamage"></div>
        <div class="sectionTitle">
          <div class="playerTitle cardTitle">
            <b id="pNameTitle">Hero</b> <span class="pill" id="pLvl">Lv1</span>
            <span class="pill statLink" id="playerStatLink">?</span>
          </div>
          <div class="pill" id="goldPill">Gold: 0</div>
        </div>
        <div class="playerCurrency">
          <div class="pill currencyPill">
            <img class="currencyIcon" src="./assets/icons/coin.svg" alt="" />
            <span id="goldValue">0</span>
          </div>
          <div class="pill currencyPill">
            <img class="currencyIcon" src="./assets/icons/gem.svg" alt="" />
            <span id="gemValue">0</span>
          </div>
        </div>

        <div class="nameSub" id="pSub">—</div>
        <div class="avatarWrap" id="pAvatarWrap" style="display:none;">
          <div class="avatarBox" id="pAvatarBox"></div>
        </div>

<div class="bars">
          <div>
            <div class="barRow">
              <span class="muted">HP</span><span class="muted" id="hpText">0/0</span>
            </div>
            <div class="bar"><div class="fill hp" id="hpBar"></div></div>
          </div>
          <div>
            <div class="barRow">
              <span class="muted">MP</span><span class="muted" id="mpText">0/0</span>
            </div>
            <div class="bar"><div class="fill mp" id="mpBar"></div></div>
          </div>

          <div id="xpGroup">
            <div class="barRow">
              <span class="muted">XP</span><span class="muted" id="xpText">0/0</span>
            </div>
            <div class="bar"><div class="fill xp" id="xpBar"></div></div>
          </div>
        </div>
              </div>
        </div>

        <div class="card allyCard extra" data-ally-slot="1">
          <div class="sectionTitle">
            <div class="cardTitle allyTitle"><b class="allyName" data-ally-name="1">NPC 1</b> <span class="pill allyLvl" data-ally-lvl="1">Lv-</span></div>
            <span class="pill muted allyTag" data-ally-tag="1">Ally</span>
          </div>
          <div class="nameSub allySub" data-ally-sub="1">Slot kosong</div>
          <div class="bars allyBars" data-ally-bars="1">
            <div>
              <div class="barRow">
                <span class="muted">HP</span><span class="muted allyHpText" data-ally-hp="1">0/0</span>
              </div>
              <div class="bar"><div class="fill hp allyHpBar" data-ally-hpbar="1" style="width:0%"></div></div>
            </div>
            <div>
              <div class="barRow">
                <span class="muted">MP</span><span class="muted allyMpText" data-ally-mp="1">0/0</span>
              </div>
              <div class="bar"><div class="fill mp allyMpBar" data-ally-mpbar="1" style="width:0%"></div></div>
            </div>
          </div>
        </div>

        <div class="card allyCard extra" data-ally-slot="2">
          <div class="sectionTitle">
            <div class="cardTitle allyTitle"><b class="allyName" data-ally-name="2">NPC 2</b> <span class="pill allyLvl" data-ally-lvl="2">Lv-</span></div>
            <span class="pill muted allyTag" data-ally-tag="2">Ally</span>
          </div>
          <div class="nameSub allySub" data-ally-sub="2">Slot kosong</div>
          <div class="bars allyBars" data-ally-bars="2">
            <div>
              <div class="barRow">
                <span class="muted">HP</span><span class="muted allyHpText" data-ally-hp="2">0/0</span>
              </div>
              <div class="bar"><div class="fill hp allyHpBar" data-ally-hpbar="2" style="width:0%"></div></div>
            </div>
            <div>
              <div class="barRow">
                <span class="muted">MP</span><span class="muted allyMpText" data-ally-mp="2">0/0</span>
              </div>
              <div class="bar"><div class="fill mp allyMpBar" data-ally-mpbar="2" style="width:0%"></div></div>
            </div>
          </div>
        </div>
      </div>



      <!-- RIGHT: Enemy ONLY -->
      <div class="enemyRow" id="enemyRow">
        <div class="card enemyCard" id="enemyCard">
          <div class="damageText" id="enemyDamage"></div>
          <div class="sectionTitle">
            <div class="cardTitle enemyTitle"><b id="eNameTitle">-</b> <span class="pill" id="eLvl">-</span></div>
            <button class="pill muted iconPill" id="btnEnemyStats" type="button">?</button>
          </div>

          <div class="nameSub" id="eSub">—</div>
          <div class="avatarWrap" id="eAvatarWrap" style="display:none;">
            <div class="avatarBox" id="eAvatarBox"></div>
          </div>

<div class="bars" id="enemyBars" style="display:none;">
            <div>
              <div class="barRow">
                <span class="muted">HP</span><span class="muted" id="eHpText">0/0</span>
              </div>
              <div class="bar"><div class="fill hp" id="eHpBar"></div></div>
            </div>
            <div>
              <div class="barRow">
                <span class="muted">MP</span><span class="muted" id="eMpText">0/0</span>
              </div>
              <div class="bar"><div class="fill mp" id="eMpBar"></div></div>
            </div>
          </div>
        </div>
      </div>

      
      <!-- ACTION: Battle actions FULL WIDTH -->
      <div class="card actionCard" id="actionCard" style="display:none;">
        <div class="sectionTitle">
          <div><b>ACTION</b></div>
          <div class="rightPills">
            <div class="pill muted" id="turnCount">Turn: 0</div>
            <div class="pill muted" id="actionHint">—</div>
          </div>
        </div>

        <!-- Battle buttons -->
        <div class="battleActions" id="battleBtns" style="display:none;">
          <div class="battlePrimary">
            <button class="primary" id="btnAttack">Attack</button>
            <button id="btnCharge">Charge</button>
            <button id="btnItem">Item</button>
            <button id="btnDefend">Dodge</button>
            <div id="skillSlots" class="skillGrid">
              <button class="skillSlot" data-slot="0">-</button>
              <button class="skillSlot" data-slot="1">-</button>
              <button class="skillSlot" data-slot="2">-</button>
              <button class="skillSlot" data-slot="3">-</button>
              <button class="skillSlot" data-slot="4">-</button>
              <button class="skillSlot" data-slot="5">-</button>
              <button class="skillSlot" data-slot="6">-</button>
              <button class="skillSlot" data-slot="7">-</button>
            </div>
            <button class="warn" id="btnRun">Run</button>
          </div>
        </div>

        <!-- Town buttons -->
        <div class="battleActions" id="townBtns" style="display:none;">
          <div class="battlePrimary">
            <button class="primary" id="btnExplore">Adventure</button>
            <button id="btnInventory">Inventory</button>
            <button id="btnProfile">Profile</button>
            <button id="btnShop">Shop</button>
            <button class="good" id="btnMenu">Menu</button>
          </div>
        </div>
      </div>

    </div>
  </div>
  <div id="toast" class="toast" role="status" aria-live="polite"></div>
  <div id="battleResultBackdrop" class="battleResultBackdrop" style="display:none;">
    <div class="battleResultCard">
      <div class="battleResultTitle" id="battleResultTitle">Victory</div>
      <div class="battleResultEnemy" id="battleResultEnemy"></div>
      <div class="battleResultLine" id="battleResultGold">Gold +0</div>
      <div class="battleResultLine" id="battleResultXp">XP +0</div>
      <div class="battleResultLine" id="battleResultDrops">Drop: -</div>
      <button class="battleResultBtn" id="battleResultClose">Continue</button>
    </div>
  </div>

  <!-- Modal (tetap satu kali) -->
  <div class="modalBackdrop" id="modalBackdrop">
    <div class="modal">
      <div class="modalHeader">
        <div class="modalTitle" id="modalTitle">Pilih</div>
        <div class="modalMeta" id="modalMeta"></div>
        <div class="modalHeaderActions">
          <button class="xbtn back" id="modalBack" type="button">Back</button>
          <button class="xbtn" id="modalClose" type="button">Tutup</button>
        </div>
      </div>
      <div class="modalBody" id="modalBody"></div>
</div>
  </div>
  <!-- Scripts (bundled, non-module) -->
  <script>
    // Cache-buster version (update when repackaging)
    window.__APP_VER__ = "v18";
    window.__BUNDLE_LOADED__ = false;
  </script>

  <script src="./js/bundle.js?v=v37" defer></script>

  <script>
    // If bundle didn't run, show hint in-menu (no DevTools needed)
    setTimeout(function(){
      if(!window.__BUNDLE_LOADED__){
        var el=document.getElementById('menuSub');
        if(el) el.textContent='JS belum jalan (bundle.js tidak dieksekusi). Coba refresh + matikan cache.';
      } else {
        // Optional: show loaded status
        var el2=document.getElementById('menuSub');
        if(el2 && el2.textContent.trim()==='Pilih opsi:') el2.textContent='Pilih opsi:';
      }
    }, 1200);
  </script>
</body>

</html>
